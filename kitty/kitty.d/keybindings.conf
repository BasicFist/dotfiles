# ═══════════════════════════════════════════════════════════
# ⌨️ KEYBOARD SHORTCUTS
# ═══════════════════════════════════════════════════════════
# Comprehensive keybinding configuration for Kitty terminal
# All custom shortcuts in one organized module

# Clear default mappings first
clear_all_shortcuts yes
kitty_mod ctrl+shift

# --- Window/Split Management ---
map ctrl+shift+enter launch --cwd=current
map ctrl+shift+w close_window
map ctrl+shift+minus launch --location=hsplit --cwd=current
map ctrl+shift+backslash launch --location=vsplit --cwd=current
map ctrl+alt+h launch --location=hsplit --cwd=current
map ctrl+alt+v launch --location=vsplit --cwd=current
map ctrl+shift+left neighboring_window left
map ctrl+shift+right neighboring_window right
map ctrl+shift+up neighboring_window up
map ctrl+shift+down neighboring_window down

# --- Tab Management ---
map ctrl+shift+t new_tab
map ctrl+shift+q close_tab
map ctrl+shift+] next_tab
map ctrl+shift+[ previous_tab
map ctrl+1 goto_tab 1
map ctrl+2 goto_tab 2
map ctrl+3 goto_tab 3
map ctrl+4 goto_tab 4
map ctrl+5 goto_tab 5
map ctrl+f1 goto_tab 1
map ctrl+f2 goto_tab 2
map ctrl+f3 goto_tab 3
map ctrl+f4 goto_tab 4
map ctrl+f5 goto_tab 5

# --- Scrolling ---
map ctrl+shift+k scroll_line_up
map ctrl+shift+j scroll_line_down
map ctrl+shift+page_up scroll_page_up
map ctrl+shift+page_down scroll_page_down
map ctrl+shift+home scroll_home
map ctrl+shift+end scroll_end

# --- Search & Scrollback ---
map ctrl+shift+f search
map ctrl+shift+h show_scrollback

# --- Font Size ---
map ctrl+shift+plus change_font_size all +2.0
map ctrl+shift+backspace change_font_size all 0

# Note: Ctrl+Shift+Minus conflicts with window split
# Use Ctrl+Shift+Backspace to reset font size instead

# --- Opacity Controls ---
map ctrl+alt+period set_background_opacity +0.02
map ctrl+alt+comma set_background_opacity -0.02
map ctrl+alt+0 set_background_opacity 0.98

# --- System Monitor (Title Bar Display) ---
map ctrl+alt+m launch --type=background ~/.config/kitty/system-monitor.sh
map ctrl+alt+shift+m launch --type=overlay ~/.config/kitty/stop-monitor.sh

# --- Disabled Features (Effects Removed) ---
# Visual effects keybindings disabled (serve no purpose)
map ctrl+alt+g no_op
map ctrl+alt+p no_op

# Cursor trail toggle keybindings freed for other uses
map ctrl+alt+t no_op

# --- fzf Integrations (AI Agents) ---
map ctrl+alt+f launch --type=overlay ${HOME}/.config/kitty/scripts/ai-session-browse-fzf.sh
map ctrl+alt+k launch --type=overlay ${HOME}/.config/kitty/scripts/ai-kb-search-fzf.sh
map ctrl+alt+p launch --type=overlay ${HOME}/.config/kitty/scripts/ai-pane-fzf.sh
map ctrl+alt+l launch --type=overlay ${HOME}/.config/kitty/scripts/ai-mode-fzf.sh

# --- Monitoring Dashboards ---
map ctrl+shift+g launch --type=tab --tab-title "GPU" sh -c 'if command -v nvidia-smi >/dev/null 2>&1; then while :; do nvidia-smi; sleep 2; done; else echo "nvidia-smi not found"; read; fi'
map ctrl+shift+s launch --type=tab --tab-title "Sensors" sh -c 'if command -v sensors >/dev/null 2>&1; then while :; do sensors; sleep 2; done; else echo "lm-sensors not installed"; read; fi'

# --- Image Viewer ---
map ctrl+shift+i launch --type=overlay sh -c 'read -r -p "Image path: " f && [ -f "$f" ] && kitty +kitten icat "$f" || echo "File not found: $f"'

# --- Command Palette ---
map ctrl+shift+space launch --type=overlay kitty +kitten hints --type=option

# --- Copy/Paste (Enhanced) ---
# Standard clipboard operations
map ctrl+shift+c copy_to_clipboard
map ctrl+shift+v paste_from_clipboard

# X11-style selection copy/paste
map shift+insert paste_from_selection
mouse_map middle release ungrabbed paste_from_selection

# Advanced paste operations
map ctrl+shift+alt+v paste_from_clipboard
map ctrl+alt+v paste_from_selection

# Copy to both clipboard and selection
map ctrl+shift+alt+c copy_and_clear_or_interrupt

# Paste without newlines (useful for multi-line commands)
map ctrl+shift+p combine : paste_from_clipboard : send_text all \x20

# Clipboard manager (stats, history, clear)
map ctrl+shift+alt+p launch --type=overlay ~/.config/kitty/clipboard-manager.sh

# Application-specific fixes
# For DROID and other applications that may have issues with arrow keys in interactive mode
# These mappings ensure proper escape sequences are sent
map up send_text normal,application \x1b[A
map down send_text normal,application \x1b[B
map right send_text normal,application \x1b[C
map left send_text normal,application \x1b[D

# --- Miscellaneous ---
map ctrl+shift+f11 toggle_fullscreen
map ctrl+shift+u kitten unicode_input
map kitty_mod+/ kitten ~/.config/kitty/kittens/shortcuts_menu/main.py
map ctrl+shift+question kitten ~/.config/kitty/kittens/shortcuts_menu/main.py
map ctrl+slash kitten ~/.config/kitty/kittens/shortcuts_menu/main.py
map ctrl+shift+underscore kitten ~/.config/kitty/kittens/shortcuts_menu/main.py
map ctrl+underscore kitten ~/.config/kitty/kittens/shortcuts_menu/main.py
map f12 kitten ~/.config/kitty/kittens/shortcuts_menu/main.py
map ctrl+shift+1 send_text current "BIND\n"
map ctrl+shift+escape kitty_shell window
map ctrl+alt+o launch --type=background ${HOME}/.config/kitty/scripts/toggle-transparency.sh
map ctrl+alt+s launch --type=background ${HOME}/.config/kitty/scripts/toggle-scratchpad.sh
map ctrl+alt+a launch --type=background ${HOME}/.config/kitty/scripts/agent-terminal.sh toggle
map ctrl+alt+shift+a launch --type=background ${HOME}/.config/kitty/scripts/agent-terminal.sh focus
map ctrl+alt+shift+h launch --type=background --env KITTY_AGENT_LAUNCH_MODE=hsplit ${HOME}/.config/kitty/scripts/agent-terminal.sh toggle
map ctrl+alt+shift+v launch --type=background --env KITTY_AGENT_LAUNCH_MODE=vsplit ${HOME}/.config/kitty/scripts/agent-terminal.sh toggle
map ctrl+alt+x launch --type=tab --cwd=current ${HOME}/.config/kitty/scripts/launch-shared-tmux.sh
map ctrl+alt+shift+x launch --type=tab --cwd=current ${HOME}/.config/kitty/scripts/launch-ai-agents-tmux.sh
map ctrl+alt+m launch --type=overlay ${HOME}/.config/kitty/scripts/ai-agents-tui.sh
map ctrl+alt+shift+t launch --type=overlay kitten choose-theme
map ctrl+alt+shift+d launch --type=overlay kitten diff

# ═══════════════════════════════════════════════════════════
# 📝 KEYBINDINGS NOTES
# ═══════════════════════════════════════════════════════════
# Window Management:
# - Ctrl+Shift+Enter: New window (inherits current directory)
# - Ctrl+Shift+-/=: Horizontal/Vertical split
# - Ctrl+Shift+Arrows: Navigate between windows
#
# Tab Management:
# - Ctrl+Shift+T: New tab
# - Ctrl+Shift+[/]: Previous/Next tab
# - Ctrl+1-5: Jump to tab 1-5
#
# Display Control:
# - Ctrl+Shift++: Increase font ±2pt
# - Ctrl+Shift+Backspace: Reset font to default
# - Ctrl+Alt+,/.: Decrease/Increase opacity ±2%
# - Ctrl+Alt+0: Reset opacity to 98%
#
# AI Agents:
# - Ctrl+Alt+Shift+X: Launch AI Agents tmux session
# - Ctrl+Alt+M: AI Agents Management TUI
# - Ctrl+Alt+F: fzf Session Browser (⭐ NEW!)
# - Ctrl+Alt+K: fzf Knowledge Base Search (⭐ NEW!)
# - Ctrl+Alt+P: fzf Tmux Pane Switcher (⭐ NEW!)
# - Ctrl+Alt+L: fzf Mode Quick Launcher (⭐ NEW!)
#
# Monitoring:
# - Ctrl+Shift+G: GPU monitor (nvidia-smi loop)
# - Ctrl+Shift+S: Sensors monitor (lm-sensors loop)
#
# Utilities:
# - Ctrl+Shift+I: Image viewer (kitty icat)
# - Ctrl+Shift+Space: Command palette (hints)
# - Ctrl+Shift+F: Search scrollback
# - Ctrl+Shift+/: Show keyboard shortcuts (overlay)
# - Ctrl+Shift+H: Open scrollback in pager (kitty default)
# - Ctrl+Shift+F11: Fullscreen toggle
# - Ctrl+Shift+U: Unicode input
# - Ctrl+Shift+Escape: Kitty shell (debug)
#
# Copy/Paste (Enhanced):
# - Ctrl+Shift+C: Copy to clipboard (standard)
# - Ctrl+Shift+V: Paste from clipboard (standard)
# - Shift+Insert: Paste from primary selection (X11-style)
# - Middle-click: Paste from selection (mouse)
# - Ctrl+Alt+V: Paste from primary selection
# - Ctrl+Shift+P: Paste without newlines (flatten multi-line)
# - Ctrl+Shift+Alt+P: Clipboard manager (show/stats/clear)
# - Auto copy-on-select: Enabled (just select text to copy)
# ═══════════════════════════════════════════════════════════
